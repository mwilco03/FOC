<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bash Lab - FOC</title>
<style>
:root{--bg:#0a0e17;--card:#141925;--border:#2a3650;--text:#e2e8f0;--muted:#64748b;--cyan:#06b6d4;--green:#10b981;--red:#ef4444;--blue:#3b82f6;--amber:#f59e0b}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
.container{max-width:820px;margin:0 auto;padding:1rem}
.top-bar{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border);margin-bottom:1rem}
.top-bar a{color:var(--muted);text-decoration:none;font-size:.8rem}
.top-bar a:hover{color:var(--cyan)}
.top-bar h1{font-family:'JetBrains Mono',monospace;font-size:1.1rem;color:var(--cyan)}
.tabs{display:flex;gap:.5rem;margin-bottom:1rem;flex-wrap:wrap}
.tab-btn{font-family:inherit;font-size:.82rem;padding:.5rem 1rem;background:var(--card);border:1px solid var(--border);border-radius:6px;color:var(--muted);cursor:pointer}
.tab-btn.active{color:var(--cyan);border-color:var(--cyan);background:rgba(6,182,212,.08)}
.tab-panel{display:none}
.tab-panel.active{display:block}
.stats{font-size:.75rem;color:var(--muted);margin-bottom:1rem;display:flex;gap:1.5rem}
.stats .v{color:var(--cyan);font-weight:700}
details{background:var(--card);border:1px solid var(--border);border-radius:8px;margin-bottom:.6rem;overflow:hidden}
summary{padding:.75rem 1rem;cursor:pointer;font-weight:600;font-size:.88rem;list-style:none}
summary::-webkit-details-marker{display:none}
summary::before{content:'\25B6';display:inline-block;margin-right:.5rem;font-size:.65rem;transition:transform .2s}
details[open]>summary::before{transform:rotate(90deg)}
.ref-body{padding:0 1rem 1rem}
.ref-body p{font-size:.82rem;color:var(--muted);line-height:1.6;margin-bottom:.5rem}
pre{background:#0d1117;border:1px solid var(--border);border-radius:6px;padding:.75rem;font-family:'JetBrains Mono',monospace;font-size:.78rem;overflow-x:auto;line-height:1.5;color:#c9d1d9;margin:.5rem 0}
code{font-family:'JetBrains Mono',monospace;font-size:.82rem;background:rgba(6,182,212,.1);padding:1px 5px;border-radius:3px;color:var(--cyan)}
.drill-card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:1.2rem;margin-bottom:1rem}
.drill-card .prompt{font-size:.82rem;color:var(--muted);margin-bottom:.5rem;line-height:1.5}
.drill-card .func-sig{font-family:'JetBrains Mono',monospace;font-size:.8rem;color:#c9d1d9;background:#0d1117;padding:.6rem;border-radius:6px;margin-bottom:.6rem;white-space:pre-wrap;line-height:1.5}
.drill-card .func-sig .todo{color:var(--amber)}
.drill-card .tests{font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--muted);margin-bottom:.6rem;line-height:1.5}
.input-row{display:flex;gap:.5rem}
.input-row input{flex:1;font-family:'JetBrains Mono',monospace;font-size:.82rem;padding:.5rem;background:#0d1117;border:1px solid var(--border);border-radius:6px;color:var(--text);outline:none}
.input-row input:focus{border-color:var(--blue)}
.input-row input.correct{border-color:var(--green);background:rgba(16,185,129,.08)}
.input-row input.wrong{border-color:var(--red);background:rgba(239,68,68,.08)}
.btn{font-family:inherit;font-size:.78rem;padding:.45rem .9rem;border:none;border-radius:6px;cursor:pointer;color:#fff}
.btn-check{background:var(--blue)}
.btn-check:hover{background:#2563eb}
.btn-next{background:var(--cyan);color:#000}
.btn-next:hover{background:#0891b2}
.feedback{font-size:.78rem;margin-top:.5rem;min-height:1.2em}
.feedback.correct{color:var(--green)}
.feedback.wrong{color:var(--red)}
.quiz-q{font-size:.88rem;margin-bottom:.75rem;line-height:1.5}
.quiz-opts{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
.quiz-opt{font-size:.82rem;padding:.6rem;background:var(--card);border:2px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:inherit}
.quiz-opt:hover:not(.disabled){border-color:var(--blue)}
.quiz-opt.correct{border-color:var(--green);background:rgba(16,185,129,.1);color:var(--green)}
.quiz-opt.wrong{border-color:var(--red);background:rgba(239,68,68,.1);color:var(--red)}
.quiz-opt.disabled{pointer-events:none;opacity:.6}
@media(max-width:600px){.quiz-opts{grid-template-columns:1fr}.input-row{flex-direction:column}}
</style>
</head>
<body>
<div class="container">
<div class="top-bar"><a href="index.html">&larr; Home</a><h1>Bash Lab</h1><span style="font-size:.7rem;color:var(--muted)">FOC</span></div>
<div class="tabs">
<button class="tab-btn active" data-tab="ref">Reference</button>
<button class="tab-btn" data-tab="drill">Challenge Drill</button>
<button class="tab-btn" data-tab="quiz">Quick Quiz</button>
</div>

<!-- ======= REFERENCE ======= -->
<div class="tab-panel active" id="tab-ref">
<details open><summary>Variables &amp; Basics</summary><div class="ref-body">
<p>Variables are assigned with <code>=</code> (no spaces). Reference with <code>$</code>. <code>#</code> starts a comment. Use <code>echo</code> or <code>printf</code> for output.</p>
<pre>#!/bin/bash
name="Alice"
echo "Hello, $name!"      # double quotes expand vars
echo 'Hello, $name!'      # single quotes are literal
read -p "Enter: " input   # read user input
x=42
echo $((x + 8))           # arithmetic: 50</pre>
</div></details>

<details><summary>Control Flow</summary><div class="ref-body">
<pre># if / elif / else
if [[ $x -gt 10 ]]; then
    echo "big"
elif [[ $x -gt 0 ]]; then
    echo "small"
else
    echo "zero or negative"
fi

# for loop
for i in 1 2 3 4 5; do echo $i; done
for i in $(seq 1 10); do echo $i; done
for f in *.txt; do echo "$f"; done

# while loop
while [[ $x -gt 0 ]]; do
    echo $x
    ((x--))
done

# case
case "$input" in
    start)   echo "Starting...";;
    stop)    echo "Stopping...";;
    *)       echo "Unknown";;
esac</pre>
</div></details>

<details><summary>Functions</summary><div class="ref-body">
<pre># Define and call functions
greet() {
    local name="$1"
    echo "Hello, $name!"
}
greet "Alice"              # Hello, Alice!

add() {
    echo $(($1 + $2))
}
result=$(add 5 3)          # capture output: 8

# $@ = all arguments, $# = argument count
# $? = exit status of last command
# $0 = script name</pre>
</div></details>

<details><summary>Text Processing</summary><div class="ref-body">
<p>Core text tools: <code>awk</code>, <code>sed</code>, <code>tr</code>, <code>cut</code>, <code>sort</code>, <code>uniq</code>, <code>grep</code>.</p>
<pre># awk - field processing
echo "Alice 30 NY" | awk '{print $1, $3}'    # Alice NY
awk -F',' '{print $2}' data.csv              # 2nd CSV field

# sed - stream editor
sed 's/old/new/g' file.txt                   # replace all
sed -i 's/foo/bar/' file.txt                 # in-place edit

# tr - translate characters
echo "hello" | tr 'a-z' 'A-Z'               # HELLO
echo "hello" | tr -d 'aeiou'                # hll

# cut - extract fields
echo "a,b,c" | cut -d',' -f2                # b

# sort + uniq
sort file.txt | uniq -c                     # count unique lines
sort -n numbers.txt                         # numeric sort

# grep
grep -i "error" *.log                       # case-insensitive
grep -c "pattern" file.txt                  # count matches
grep -r "TODO" .                            # recursive search</pre>
</div></details>

<details><summary>Arrays &amp; Data</summary><div class="ref-body">
<pre># Indexed arrays
arr=(apple banana cherry)
echo ${arr[0]}              # apple
echo ${arr[@]}              # all elements
echo ${#arr[@]}             # length: 3

# Associative arrays (bash 4+)
declare -A map
map[name]="Alice"
map[age]=30
echo ${map[name]}           # Alice

# Sequence & shuffle
seq 1 5                     # 1 2 3 4 5
shuf -e a b c d             # random order

# Read into array
mapfile -t lines &lt; file.txt

# jq for JSON
echo '{"name":"Alice"}' | jq '.name'    # "Alice"
curl -s api.example.com | jq '.[0]'</pre>
</div></details>

<details><summary>File &amp; System</summary><div class="ref-body">
<pre># File tests
[[ -f "file.txt" ]]    # exists and is file
[[ -d "dir" ]]         # exists and is directory
[[ -s "file.txt" ]]    # exists and not empty

# Read file line by line
while IFS= read -r line; do
    echo "$line"
done &lt; file.txt

# File info
stat file.txt                # metadata
basename "/path/to/file.txt" # file.txt
dirname "/path/to/file.txt"  # /path/to
wc -l file.txt               # line count

# Processes
ps aux                       # all processes
kill -9 &lt;PID&gt;                # force kill
pgrep -f "pattern"           # find by name</pre>
</div></details>

<details><summary>Networking</summary><div class="ref-body">
<pre># Connectivity
ping -c 3 google.com
curl -s https://api.example.com
wget -q -O file.html https://example.com

# Port checks
nc -zv host 80               # TCP port test
ss -tuln                      # listening sockets
netstat -tulnp                # legacy alternative

# DNS
dig example.com
nslookup example.com
host example.com</pre>
</div></details>

<details><summary>Scripting Best Practices</summary><div class="ref-body">
<pre># Safe mode - stop on errors
set -euo pipefail

# Cleanup on exit
trap 'rm -f /tmp/mytemp' EXIT

# Quote all variable expansions
echo "$variable"              # correct
echo $variable                # risky with spaces

# Forward arguments safely
my_func "$@"

# Check command exists
command -v curl &>/dev/null || echo "curl not found"

# Timeout long commands
timeout 5s ping google.com</pre>
</div></details>

<details><summary>Special Variables &amp; Operators</summary><div class="ref-body">
<pre>$?     # exit status of last command (0=success)
$@     # all arguments (preserves quoting)
$#     # number of arguments
$0     # script name
$$     # current process ID
!!     # re-run last command (interactive)

# Redirection
cmd > out.txt       # stdout to file
cmd 2> err.txt      # stderr to file
cmd &> all.txt      # both to file
cmd1 | cmd2         # pipe stdout

# Logical operators
cmd1 && cmd2        # run cmd2 if cmd1 succeeds
cmd1 || cmd2        # run cmd2 if cmd1 fails</pre>
</div></details>
</div>

<!-- ======= CHALLENGE DRILL ======= -->
<div class="tab-panel" id="tab-drill">
<div class="stats">SCORE: <span class="v" id="d-score">0</span> &nbsp; STREAK: <span class="v" id="d-streak">0</span> &nbsp; <span id="d-num">1</span>/<span id="d-total">20</span></div>
<div id="drill-area"></div>
</div>

<!-- ======= QUICK QUIZ ======= -->
<div class="tab-panel" id="tab-quiz">
<div class="stats">SCORE: <span class="v" id="q-score">0</span> &nbsp; STREAK: <span class="v" id="q-streak">0</span> &nbsp; <span id="q-num">1</span>/<span id="q-total">20</span></div>
<div id="quiz-area"></div>
</div>
</div>

<script>
// Tabs
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-'+btn.dataset.tab).classList.add('active');
  });
});

// ============ DRILL ============
const DRILLS=[
{sig:'add_two_numbers() {\n  local a=$1\n  local b=$2\n  # TODO: Print the sum of $a and $b\n}',tests:'add_two_numbers 2 3 -> 5',answers:['echo $((a + b))','echo $(($a + $b))','echo $((a+b))']},
{sig:'greet_user() {\n  local name="$1"\n  # TODO: Print "Hello, <name>!"\n}',tests:'greet_user "Alex" -> Hello, Alex!',answers:['echo "Hello, $name!"','echo "Hello, ${name}!"']},
{sig:'is_even() {\n  local n=$1\n  # TODO: Print "true" if even, "false" otherwise\n}',tests:'is_even 4 -> true   is_even 3 -> false',answers:['if (( n % 2 == 0 )); then echo "true"; else echo "false"; fi','[[ $((n % 2)) -eq 0 ]] && echo "true" || echo "false"']},
{sig:'reverse_string() {\n  local text="$1"\n  # TODO: Reverse $text\n}',tests:'reverse_string "Bash" -> hsaB',answers:['echo "$text" | rev','echo $text | rev']},
{sig:'count_words() {\n  local sentence="$1"\n  # TODO: Count words in $sentence\n}',tests:'count_words "Bash is fun" -> 3',answers:['echo "$sentence" | wc -w','echo $sentence | wc -w']},
{sig:'get_extension() {\n  local file="$1"\n  # TODO: Extract and print file extension\n}',tests:'get_extension "doc.txt" -> txt',answers:['echo "${file##*.}"']},
{sig:'validate_email() {\n  local email="$1"\n  # TODO: Check email format with regex\n}',tests:'"user@example.com" -> valid',answers:['[[ "$email" =~ ^[^@]+@[^@]+\\.[^@]+$ ]] && echo "valid" || echo "invalid"']},
{sig:'to_upper() {\n  local input="$1"\n  # TODO: Convert to uppercase using tr\n}',tests:'to_upper "hello" -> HELLO',answers:["echo \"$input\" | tr 'a-z' 'A-Z'","echo \"$input\" | tr '[a-z]' '[A-Z]'","echo ${input^^}"]},
{sig:'show_menu() {\n  local input="$1"\n  # TODO: Use case to handle start/stop/restart/exit\n}',tests:'"start" -> Starting...',answers:['case "$input" in start) echo "Starting...";; stop) echo "Stopping...";; restart) echo "Restarting...";; exit) echo "Exiting...";; esac']},
{sig:'replace_text() {\n  local file="$1" search="$2" replace="$3"\n  # TODO: Use sed to replace text in-place\n}',tests:'replaces "foo" with "bar" in file',answers:["sed -i \"s/$search/$replace/g\" \"$file\"","sed -i 's/'$search'/'$replace'/g' $file"]},
{sig:'parse_fields() {\n  local line="$1"\n  # TODO: Use awk to print first and second field\n}',tests:'"name,age,city" -> name age',answers:["echo \"$line\" | awk -F',' '{print $1, $2}'","echo $line | awk -F, '{print $1,$2}'"]},
{sig:'multiply_array() {\n  local arr=("$@")\n  # TODO: Multiply all elements\n}',tests:'multiply_array 1 2 3 -> 6',answers:['local result=1; for n in "${arr[@]}"; do ((result*=n)); done; echo $result']},
{sig:'sum_args() {\n  # TODO: Sum any number of arguments\n}',tests:'sum_args 1 2 3 -> 6',answers:['local s=0; for n in "$@"; do ((s+=n)); done; echo $s']},
{sig:'check_file() {\n  local file="$1"\n  # TODO: Print "exists", "empty", or "missing"\n}',tests:'/etc/passwd -> exists',answers:['if [[ -s "$file" ]]; then echo "exists"; elif [[ -f "$file" ]]; then echo "empty"; else echo "missing"; fi']},
{sig:'generate_range() {\n  local start=$1 end=$2\n  # TODO: Use seq to print range\n}',tests:'generate_range 1 5 -> 1 2 3 4 5',answers:['seq $start $end','seq "$start" "$end"']},
{sig:'sort_unique() {\n  local list="$1"\n  # TODO: Sort and remove duplicates\n}',tests:'"3 1 2 3 1" -> 1 2 3',answers:['echo "$list" | tr " " "\\n" | sort -n | uniq | tr "\\n" " "','echo $list | tr " " "\\n" | sort -nu | tr "\\n" " "']},
{sig:'check_command() {\n  local cmd="$1"\n  # TODO: Check if command exists\n}',tests:'check_command "bash" -> found',answers:['command -v "$cmd" &>/dev/null && echo "found" || echo "not found"','which "$cmd" &>/dev/null && echo "found" || echo "not found"']},
{sig:'generate_password() {\n  local length="$1"\n  # TODO: Generate random alphanumeric password\n}',tests:'generate_password 8 -> 8-char string',answers:["tr -dc 'A-Za-z0-9' < /dev/urandom | head -c $length","cat /dev/urandom | tr -dc 'a-zA-Z0-9' | head -c $length"]},
{sig:'pipeline_grep_count() {\n  local pattern="$1" file="$2"\n  # TODO: Count lines matching pattern\n}',tests:'"bash" "/etc/passwd" -> count',answers:['grep -c "$pattern" "$file"','grep "$pattern" "$file" | wc -l']},
{sig:'print_banner() {\n  local msg="$1"\n  # TODO: Print centered in 60-char banner with = padding\n}',tests:'"WELCOME" -> === WELCOME ===',answers:['local pad=$(( (60 - ${#msg}) / 2 )); printf "%*s%s%*s\\n" $pad "" "$msg" $pad ""']},
];

let dIdx=0,dScore=0,dStreak=0;
document.getElementById('d-total').textContent=DRILLS.length;

function showDrill(){
  const d=DRILLS[dIdx];
  document.getElementById('d-num').textContent=dIdx+1;
  const area=document.getElementById('drill-area');
  area.innerHTML=`<div class="drill-card">
    <div class="func-sig">${d.sig.replace(/# TODO/g,'<span class="todo"># TODO</span>')}</div>
    <div class="tests">${d.tests}</div>
    <div class="prompt">Type the missing line(s):</div>
    <div class="input-row"><input type="text" id="drill-input" placeholder="echo ..."><button class="btn btn-check" onclick="checkDrill()">Check</button></div>
    <div class="feedback" id="drill-fb"></div>
    <div style="margin-top:.5rem;text-align:right"><button class="btn btn-next" onclick="nextDrill()" style="display:none" id="drill-next">Next</button></div>
  </div>`;
  document.getElementById('drill-input').addEventListener('keydown',e=>{if(e.key==='Enter')checkDrill()});
  document.getElementById('drill-input').focus();
}

function checkDrill(){
  const inp=document.getElementById('drill-input');
  const fb=document.getElementById('drill-fb');
  const val=inp.value.trim().replace(/\s+/g,' ');
  const d=DRILLS[dIdx];
  const ok=d.answers.some(a=>val===a.replace(/\s+/g,' ').trim());
  if(ok){
    inp.classList.add('correct');fb.textContent='Correct!';fb.className='feedback correct';
    dScore+=10;dStreak++;
  }else{
    inp.classList.add('wrong');fb.innerHTML='Expected: <code>'+d.answers[0].replace(/</g,'&lt;').replace(/>/g,'&gt;')+'</code>';fb.className='feedback wrong';
    dStreak=0;
  }
  document.getElementById('d-score').textContent=dScore;
  document.getElementById('d-streak').textContent=dStreak;
  document.getElementById('drill-next').style.display='inline-block';
  inp.disabled=true;
}

function nextDrill(){
  dIdx=(dIdx+1)%DRILLS.length;
  showDrill();
}
showDrill();

// ============ QUIZ ============
const QUIZ=[
{q:'What character starts a comment in Bash?',opts:['#','//','--','rem'],c:0},
{q:'How do you assign a variable in Bash?',opts:['name=value','set name=value','$name=value','let name value'],c:0},
{q:'What does $? contain?',opts:['Exit status of last command','Current PID','Argument count','Script name'],c:0},
{q:'Which command reverses a string?',opts:['rev','reverse','flip','invert'],c:0},
{q:'What does set -e do in a script?',opts:['Exit on any error','Echo all commands','Enable extensions','Export variables'],c:0},
{q:'How do you reference all script arguments?',opts:['$@','$*','$#','$0'],c:0},
{q:'Which tool replaces text in a stream?',opts:['sed','tr','cut','awk'],c:0},
{q:'What does awk \'{print $2}\' do?',opts:['Prints second field','Prints second line','Prints 2 copies','Removes field 2'],c:0},
{q:'How do you make a script executable?',opts:['chmod +x script.sh','exec script.sh','run script.sh','start script.sh'],c:0},
{q:'What does | (pipe) do?',opts:['Passes stdout to next command','Logical OR','Background process','String concat'],c:0},
{q:'Which test checks if a file exists?',opts:['-f','-e','-d','-s'],c:0},
{q:'What does tr \'a-z\' \'A-Z\' do?',opts:['Converts to uppercase','Translates to hex','Removes lowercase','Trims whitespace'],c:0},
{q:'How do you declare an associative array?',opts:['declare -A','declare -a','array -A','local -A'],c:0},
{q:'What does grep -c do?',opts:['Counts matching lines','Case-insensitive','Colorizes output','Counts files'],c:0},
{q:'Which command generates a number sequence?',opts:['seq','range','series','gen'],c:0},
{q:'What does trap do?',opts:['Runs code on signal/exit','Catches errors','Creates a loop','Traps input'],c:0},
{q:'How do you get the length of a string?',opts:['${#var}','len($var)','$var.length','strlen $var'],c:0},
{q:'What does command -v check?',opts:['If a command exists','Command version','Verbose mode','Variable value'],c:0},
{q:'Which redirects stderr to a file?',opts:['2> file','&> file','> file','1> file'],c:0},
{q:'What does #!/bin/bash do?',opts:['Sets the script interpreter','Starts a comment','Imports bash library','Enables bash mode'],c:0},
];

let qIdx=0,qScore=0,qStreak=0;
document.getElementById('q-total').textContent=QUIZ.length;

function showQuiz(){
  const q=QUIZ[qIdx];
  document.getElementById('q-num').textContent=qIdx+1;
  const area=document.getElementById('quiz-area');
  area.innerHTML=`<div class="drill-card"><div class="quiz-q">${q.q}</div><div class="quiz-opts">${
    q.opts.map((o,i)=>`<button class="quiz-opt" data-i="${i}">${o}</button>`).join('')
  }</div><div class="feedback" id="quiz-fb"></div>
  <div style="margin-top:.5rem;text-align:right"><button class="btn btn-next" onclick="nextQuiz()" style="display:none" id="quiz-next">Next</button></div></div>`;
  area.querySelectorAll('.quiz-opt').forEach(btn=>{
    btn.addEventListener('click',()=>answerQuiz(parseInt(btn.dataset.i)));
  });
}

function answerQuiz(i){
  const q=QUIZ[qIdx];
  const btns=document.querySelectorAll('.quiz-opt');
  btns.forEach((b,j)=>{b.classList.add('disabled');if(j===q.c)b.classList.add('correct');if(j===i&&i!==q.c)b.classList.add('wrong')});
  const fb=document.getElementById('quiz-fb');
  if(i===q.c){qScore+=10;qStreak++;fb.textContent='Correct!';fb.className='feedback correct'}
  else{qStreak=0;fb.textContent='Wrong!';fb.className='feedback wrong'}
  document.getElementById('q-score').textContent=qScore;
  document.getElementById('q-streak').textContent=qStreak;
  document.getElementById('quiz-next').style.display='inline-block';
}

function nextQuiz(){qIdx=(qIdx+1)%QUIZ.length;showQuiz()}
showQuiz();
</script>
</body>
</html>
