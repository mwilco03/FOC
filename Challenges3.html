<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Batch Lab - FOC</title>
<style>
:root{--bg:#0a0e17;--card:#141925;--border:#2a3650;--text:#e2e8f0;--muted:#64748b;--cyan:#06b6d4;--green:#10b981;--red:#ef4444;--blue:#3b82f6;--amber:#f59e0b}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
.container{max-width:820px;margin:0 auto;padding:1rem}
.top-bar{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border);margin-bottom:1rem}
.top-bar a{color:var(--muted);text-decoration:none;font-size:.8rem}
.top-bar a:hover{color:var(--cyan)}
.top-bar h1{font-family:'JetBrains Mono',monospace;font-size:1.1rem;color:var(--cyan)}
.tabs{display:flex;gap:.5rem;margin-bottom:1rem;flex-wrap:wrap}
.tab-btn{font-family:inherit;font-size:.82rem;padding:.5rem 1rem;background:var(--card);border:1px solid var(--border);border-radius:6px;color:var(--muted);cursor:pointer}
.tab-btn.active{color:var(--cyan);border-color:var(--cyan);background:rgba(6,182,212,.08)}
.tab-panel{display:none}
.tab-panel.active{display:block}
.stats{font-size:.75rem;color:var(--muted);margin-bottom:1rem;display:flex;gap:1.5rem}
.stats .v{color:var(--cyan);font-weight:700}
details{background:var(--card);border:1px solid var(--border);border-radius:8px;margin-bottom:.6rem;overflow:hidden}
summary{padding:.75rem 1rem;cursor:pointer;font-weight:600;font-size:.88rem;list-style:none}
summary::-webkit-details-marker{display:none}
summary::before{content:'\25B6';display:inline-block;margin-right:.5rem;font-size:.65rem;transition:transform .2s}
details[open]>summary::before{transform:rotate(90deg)}
.ref-body{padding:0 1rem 1rem}
.ref-body p{font-size:.82rem;color:var(--muted);line-height:1.6;margin-bottom:.5rem}
pre{background:#0d1117;border:1px solid var(--border);border-radius:6px;padding:.75rem;font-family:'JetBrains Mono',monospace;font-size:.78rem;overflow-x:auto;line-height:1.5;color:#c9d1d9;margin:.5rem 0}
code{font-family:'JetBrains Mono',monospace;font-size:.82rem;background:rgba(6,182,212,.1);padding:1px 5px;border-radius:3px;color:var(--cyan)}
.drill-card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:1.2rem;margin-bottom:1rem}
.drill-card .prompt{font-size:.82rem;color:var(--muted);margin-bottom:.5rem;line-height:1.5}
.drill-card .func-sig{font-family:'JetBrains Mono',monospace;font-size:.8rem;color:#c9d1d9;background:#0d1117;padding:.6rem;border-radius:6px;margin-bottom:.6rem;white-space:pre-wrap;line-height:1.5}
.drill-card .func-sig .todo{color:var(--amber)}
.drill-card .tests{font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--muted);margin-bottom:.6rem;line-height:1.5}
.input-row{display:flex;gap:.5rem}
.input-row input{flex:1;font-family:'JetBrains Mono',monospace;font-size:.82rem;padding:.5rem;background:#0d1117;border:1px solid var(--border);border-radius:6px;color:var(--text);outline:none}
.input-row input:focus{border-color:var(--blue)}
.input-row input.correct{border-color:var(--green);background:rgba(16,185,129,.08)}
.input-row input.wrong{border-color:var(--red);background:rgba(239,68,68,.08)}
.btn{font-family:inherit;font-size:.78rem;padding:.45rem .9rem;border:none;border-radius:6px;cursor:pointer;color:#fff}
.btn-check{background:var(--blue)}
.btn-check:hover{background:#2563eb}
.btn-next{background:var(--cyan);color:#000}
.btn-next:hover{background:#0891b2}
.feedback{font-size:.78rem;margin-top:.5rem;min-height:1.2em}
.feedback.correct{color:var(--green)}
.feedback.wrong{color:var(--red)}
.quiz-q{font-size:.88rem;margin-bottom:.75rem;line-height:1.5}
.quiz-opts{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
.quiz-opt{font-size:.82rem;padding:.6rem;background:var(--card);border:2px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:inherit}
.quiz-opt:hover:not(.disabled){border-color:var(--blue)}
.quiz-opt.correct{border-color:var(--green);background:rgba(16,185,129,.1);color:var(--green)}
.quiz-opt.wrong{border-color:var(--red);background:rgba(239,68,68,.1);color:var(--red)}
.quiz-opt.disabled{pointer-events:none;opacity:.6}
@media(max-width:600px){.quiz-opts{grid-template-columns:1fr}.input-row{flex-direction:column}}
</style>
</head>
<body>
<div class="container">
<div class="top-bar"><a href="index.html">&larr; Home</a><h1>Batch Lab</h1><span style="font-size:.7rem;color:var(--muted)">FOC</span></div>
<div class="tabs">
<button class="tab-btn active" data-tab="ref">Reference</button>
<button class="tab-btn" data-tab="drill">Challenge Drill</button>
<button class="tab-btn" data-tab="quiz">Quick Quiz</button>
</div>

<!-- ======= REFERENCE ======= -->
<div class="tab-panel active" id="tab-ref">
<details open><summary>Basics</summary><div class="ref-body">
<p><code>@echo off</code> hides command echo. <code>echo</code> prints text. <code>pause</code> waits for a keypress. <code>rem</code> starts a comment.</p>
<pre>@echo off
echo Hello, World!
rem This is a comment
pause</pre>
</div></details>

<details><summary>Variables &amp; Input</summary><div class="ref-body">
<pre>rem Set a variable
set myvar=Hello

rem Use a variable
echo %myvar%

rem User input
set /p name=Enter your name:
echo Hello, %name%!

rem Arithmetic
set /a sum=5 + 3
set /a product=%x% * %y%
echo %sum%  %product%

rem Delayed expansion (inside blocks)
setlocal enabledelayedexpansion
set val=test
echo !val!</pre>
</div></details>

<details><summary>Conditionals</summary><div class="ref-body">
<pre>rem String comparison
if "%var%"=="value" (
    echo Match!
) else (
    echo No match.
)

rem Numeric comparison
if %num% GEQ 10 echo Big number

rem File existence
if exist "file.txt" (
    echo Found it!
) else (
    echo Not found.
)

rem Comparison operators:
rem EQU (==)  NEQ (!=)  LSS (&lt;)
rem LEQ (&lt;=)  GTR (&gt;)   GEQ (&gt;=)
rem /i = case-insensitive</pre>
</div></details>

<details><summary>Loops</summary><div class="ref-body">
<pre>rem Count from 1 to 10
for /l %%i in (1,1,10) do echo %%i

rem Loop through files
for %%f in (*.txt) do echo %%f

rem Loop through file lines
for /f "tokens=*" %%a in (data.txt) do echo %%a

rem Loop with delimiters
for /f "tokens=1,2 delims=," %%a in (data.csv) do (
    echo Name: %%a  Age: %%b
)

rem Note: In scripts use %%i
rem At command prompt use %i</pre>
</div></details>

<details><summary>File Operations</summary><div class="ref-body">
<pre>rem Create / write
echo Hello > file.txt          &amp; rem overwrite
echo World >> file.txt         &amp; rem append

rem Copy / Move / Delete
copy source.txt dest.txt
move old.txt new.txt
del file.txt
ren file.txt newname.txt

rem Directories
mkdir newfolder
rmdir /s /q oldfolder
dir /b                         &amp; rem bare listing

rem Rename pattern
for %%f in (*.txt) do ren "%%f" "%%~nf_backup.txt"</pre>
</div></details>

<details><summary>Labels &amp; Goto</summary><div class="ref-body">
<pre>rem Labels define jump points
:start
echo Menu: 1=Greet 2=Date 3=Exit
set /p choice=Choose:

if "%choice%"=="1" goto greet
if "%choice%"=="2" goto showdate
if "%choice%"=="3" goto end

:greet
echo Hello!
goto start

:showdate
date /t
goto start

:end
echo Goodbye!</pre>
</div></details>

<details><summary>String Manipulation</summary><div class="ref-body">
<pre>setlocal enabledelayedexpansion
set str=Hello World

rem Substring: !str:~start,length!
echo !str:~0,5!               &amp; rem Hello
echo !str:~6!                  &amp; rem World

rem String replace
set newstr=!str:World=Batch!
echo !newstr!                  &amp; rem Hello Batch

rem String length (loop method)
set len=0
:loop
if "!str:~%len%,1!"=="" goto done
set /a len+=1
goto loop
:done
echo Length: %len%</pre>
</div></details>

<details><summary>Useful Tricks</summary><div class="ref-body">
<pre>rem Script directory path
echo %~dp0

rem Open a file
start notepad file.txt

rem Delay execution
timeout /t 5

rem Errorlevel check
dir nofile.txt 2>nul
if %errorlevel% neq 0 echo File not found

rem Suppress errors
command 2>nul

rem Get date/time
date /t
time /t</pre>
</div></details>
</div>

<!-- ======= CHALLENGE DRILL ======= -->
<div class="tab-panel" id="tab-drill">
<div class="stats">SCORE: <span class="v" id="d-score">0</span> &nbsp; STREAK: <span class="v" id="d-streak">0</span> &nbsp; <span id="d-num">1</span>/<span id="d-total">15</span></div>
<div id="drill-area"></div>
</div>

<!-- ======= QUICK QUIZ ======= -->
<div class="tab-panel" id="tab-quiz">
<div class="stats">SCORE: <span class="v" id="q-score">0</span> &nbsp; STREAK: <span class="v" id="q-streak">0</span> &nbsp; <span id="q-num">1</span>/<span id="q-total">15</span></div>
<div id="quiz-area"></div>
</div>
</div>

<script>
// Tabs
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-'+btn.dataset.tab).classList.add('active');
  });
});

// ============ DRILL ============
const DRILLS=[
{sig:'set /p a=Enter first number:\nset /p b=Enter second number:\nrem TODO: Calculate and display the sum\nset /a sum=____\necho Sum: %sum%',tests:'a=5, b=3 -> Sum: 8',answers:['%a% + %b%','%a%+%b%']},
{sig:'set /p name=Enter your name:\nrem TODO: Print a greeting using the name\necho Hello, ____!',tests:'"Alice" -> Hello, Alice!',answers:['%name%']},
{sig:'set /p num=Enter a number:\nrem TODO: Determine if even or odd\nset /a remainder=%num% %% ____',tests:'4 -> even, 3 -> odd',answers:['2']},
{sig:'set /p fname=Enter file name (no extension):\nset /p text=Enter text to write:\nrem TODO: Write text into the given file\n____ %fname%.txt echo %text%',tests:'fname=test, text=Hello -> test.txt contains Hello',answers:['>','echo %text% > %fname%.txt']},
{sig:'rem TODO: Use a loop to print numbers 1 through 10\nfor /l %%i in (____) do (\n    echo %%i\n)',tests:'Output: 1 2 3 4 5 6 7 8 9 10',answers:['1,1,10']},
{sig:'set /p password=Enter password:\nrem TODO: Check if password is "secret123"\nif "____"=="____" (\n    echo Access granted.\n)',tests:'"secret123" -> Access granted',answers:['%password%"=="secret123']},
{sig:'set /p filename=Enter a file name:\nrem TODO: Check if the file exists\nif exist "____" (\n    echo File exists.\n)',tests:'"test.txt" -> File exists.',answers:['%filename%']},
{sig:'set /p x=Enter first number:\nset /p y=Enter second number:\nrem TODO: Multiply x and y\nset /a product=____',tests:'x=4, y=5 -> Product: 20',answers:['%x% * %y%','%x%*%y%']},
{sig:'rem TODO: Print a 5x5 multiplication table\nfor /l %%i in (1,1,____) do (\n    for /l %%j in (1,1,____) do ( ... )\n)',tests:'5x5 table from 1*1 to 5*5',answers:['5']},
{sig:'set /p input=Enter a word to reverse:\nrem TODO: Reverse the string manually\nsetlocal ____',tests:'"Bash" -> hsaB',answers:['enabledelayedexpansion']},
{sig:'rem TODO: Allow up to 3 attempts for correct password\nset attempts=____\n:login\nset /p pw=Enter password:',tests:'3 wrong -> "Too many attempts"',answers:['0']},
{sig:'rem Loop through all .txt files and rename with _backup\nfor %%f in (*.txt) do (\n    ren "%%f" "____"\n)',tests:'file.txt -> file_backup.txt',answers:['%%~nf_backup.txt']},
{sig:'rem TODO: Count characters in a string\nset len=0\n:countloop\nset char=!str:~%len%,____!\nif "!char!"=="" goto done',tests:'counts each character one at a time',answers:['1']},
{sig:'rem Set a variable and use it\nset greeting=Hello World\necho ____',tests:'Output: Hello World',answers:['%greeting%']},
{sig:'rem TODO: Use goto to jump to a label\nif "%choice%"=="1" goto ____\n...\n:greet\necho Hello!',tests:'choice=1 -> jumps to :greet',answers:['greet']},
];

let dIdx=0,dScore=0,dStreak=0;
document.getElementById('d-total').textContent=DRILLS.length;

function showDrill(){
  const d=DRILLS[dIdx];
  document.getElementById('d-num').textContent=dIdx+1;
  const area=document.getElementById('drill-area');
  area.innerHTML=`<div class="drill-card">
    <div class="func-sig">${d.sig.replace(/rem TODO/g,'<span class="todo">rem TODO</span>').replace(/____/g,'<span class="todo">____</span>')}</div>
    <div class="tests">${d.tests}</div>
    <div class="prompt">Fill in the blank (____) :</div>
    <div class="input-row"><input type="text" id="drill-input" placeholder="type answer..."><button class="btn btn-check" onclick="checkDrill()">Check</button></div>
    <div class="feedback" id="drill-fb"></div>
    <div style="margin-top:.5rem;text-align:right"><button class="btn btn-next" onclick="nextDrill()" style="display:none" id="drill-next">Next</button></div>
  </div>`;
  document.getElementById('drill-input').addEventListener('keydown',e=>{if(e.key==='Enter')checkDrill()});
  document.getElementById('drill-input').focus();
}

function checkDrill(){
  const inp=document.getElementById('drill-input');
  const fb=document.getElementById('drill-fb');
  const val=inp.value.trim().replace(/\s+/g,' ');
  const d=DRILLS[dIdx];
  const ok=d.answers.some(a=>val.toLowerCase()===a.toLowerCase().replace(/\s+/g,' ').trim());
  if(ok){
    inp.classList.add('correct');fb.textContent='Correct!';fb.className='feedback correct';
    dScore+=10;dStreak++;
  }else{
    inp.classList.add('wrong');fb.innerHTML='Expected: <code>'+d.answers[0]+'</code>';fb.className='feedback wrong';
    dStreak=0;
  }
  document.getElementById('d-score').textContent=dScore;
  document.getElementById('d-streak').textContent=dStreak;
  document.getElementById('drill-next').style.display='inline-block';
  inp.disabled=true;
}

function nextDrill(){
  dIdx=(dIdx+1)%DRILLS.length;
  showDrill();
}
showDrill();

// ============ QUIZ ============
const QUIZ=[
{q:'What does @echo off do in a batch file?',opts:['Hides command echo','Turns off the computer','Stops all output','Clears the screen'],c:0},
{q:'Which command reads user input into a variable?',opts:['set /p var=prompt','read var','input var','get var'],c:0},
{q:'How do you reference a variable in batch?',opts:['%varname%','$varname','${varname}','varname'],c:0},
{q:'What does set /a do?',opts:['Arithmetic evaluation','Array creation','Append to variable','Absolute path'],c:0},
{q:'Which command checks if a file exists?',opts:['if exist "file"','test -f file','file.exists()','check file'],c:0},
{q:'What does pause do?',opts:['Waits for a keypress','Pauses for 5 seconds','Stops the script','Saves current state'],c:0},
{q:'How do you write text to a file (overwrite)?',opts:['echo text > file.txt','echo text >> file.txt','write text file.txt','set text > file.txt'],c:0},
{q:'What is the loop variable prefix in batch scripts?',opts:['%%','$','@','#'],c:0},
{q:'Which for /l syntax counts 1 to 5?',opts:['(1,1,5)','(1..5)','(1:5)','(1-5)'],c:0},
{q:'What does goto do?',opts:['Jumps to a label','Goes to a directory','Returns to start','Exits the script'],c:0},
{q:'What does %~dp0 expand to?',opts:['Script drive and path','Current date','Desktop path','DOS prompt'],c:0},
{q:'How do you append text to a file?',opts:['echo text >> file.txt','echo text > file.txt','add text file.txt','append text file.txt'],c:0},
{q:'What does rem do?',opts:['Starts a comment','Removes a file','Renames a variable','Restarts a service'],c:0},
{q:'Which operator means "not equal" in batch?',opts:['NEQ','!=','<>','NOT'],c:0},
{q:'What enables delayed variable expansion?',opts:['setlocal enabledelayedexpansion','set delayed=on','enable !vars!','setlocal expand'],c:0},
];

let qIdx=0,qScore=0,qStreak=0;
document.getElementById('q-total').textContent=QUIZ.length;

function showQuiz(){
  const q=QUIZ[qIdx];
  document.getElementById('q-num').textContent=qIdx+1;
  const area=document.getElementById('quiz-area');
  area.innerHTML=`<div class="drill-card"><div class="quiz-q">${q.q}</div><div class="quiz-opts">${
    q.opts.map((o,i)=>`<button class="quiz-opt" data-i="${i}">${o}</button>`).join('')
  }</div><div class="feedback" id="quiz-fb"></div>
  <div style="margin-top:.5rem;text-align:right"><button class="btn btn-next" onclick="nextQuiz()" style="display:none" id="quiz-next">Next</button></div></div>`;
  area.querySelectorAll('.quiz-opt').forEach(btn=>{
    btn.addEventListener('click',()=>answerQuiz(parseInt(btn.dataset.i)));
  });
}

function answerQuiz(i){
  const q=QUIZ[qIdx];
  const btns=document.querySelectorAll('.quiz-opt');
  btns.forEach((b,j)=>{b.classList.add('disabled');if(j===q.c)b.classList.add('correct');if(j===i&&i!==q.c)b.classList.add('wrong')});
  const fb=document.getElementById('quiz-fb');
  if(i===q.c){qScore+=10;qStreak++;fb.textContent='Correct!';fb.className='feedback correct'}
  else{qStreak=0;fb.textContent='Wrong!';fb.className='feedback wrong'}
  document.getElementById('q-score').textContent=qScore;
  document.getElementById('q-streak').textContent=qStreak;
  document.getElementById('quiz-next').style.display='inline-block';
}

function nextQuiz(){qIdx=(qIdx+1)%QUIZ.length;showQuiz()}
showQuiz();
</script>
</body>
</html>
